<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>North West Passage Holdings (NWPH) | Arctic Innovation Ecosystem</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Three.js for 3D visualization -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <!-- Load Inter font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
    <style>
        /* --- Corporate Theme & Custom Styles --- */
        :root {
            --color-deep-arctic: #020617; /* Slate 950 - Deep Background */
            --color-midnight: #0F172A;    /* Slate 900 - Card Background */
            --color-ice-blue: #38BDF8;    /* Sky 400 - Primary Accent */
            --color-secondary-accent: #06B6D4; /* Cyan 500 - Secondary Accent */
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--color-deep-arctic);
            background-image: radial-gradient(at 10% 10%, #0c4a6e 0%, transparent 50%), radial-gradient(at 90% 90%, #0369a1 0%, transparent 50%);
            color: white;
            line-height: 1.6;
        }

        /* High-Impact Card Styling */
        .cyber-card {
            background-color: var(--color-midnight);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.5), 0 2px 4px -2px rgba(0, 0, 0, 0.5), inset 0 0 10px rgba(56, 189, 248, 0.1);
            border: 1px solid rgba(56, 189, 248, 0.3);
            border-radius: 16px;
            transition: all 0.3s ease-in-out;
        }

        .cyber-card:hover {
            border-color: var(--color-ice-blue);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.7), 0 4px 6px -4px rgba(0, 0, 0, 0.7), inset 0 0 15px rgba(56, 189, 248, 0.3);
            transform: translateY(-2px);
        }

        /* Subtle Loading Spinner */
        .tech-loader {
            width: 3rem;
            height: 3rem;
            border: 5px solid var(--color-ice-blue);
            border-top-color: transparent;
            border-radius: 50%;
            animation: rotate-load 1s linear infinite;
        }
        @keyframes rotate-load {
            to { transform: rotate(360deg); }
        }

        /* Navigation Active State */
        .nav-link.active {
            color: var(--color-ice-blue);
            border-bottom: 3px solid var(--color-ice-blue);
            padding-bottom: 0.75rem;
        }

        /* 3D Canvas Styling */
        #three-canvas-container {
            height: 450px;
            width: 100%;
            background-color: #000;
        }
    </style>
</head>
<body>

    <div id="app" class="min-h-screen flex flex-col">
        <!-- Application content will be rendered here -->
    </div>

    <script>
        // --- Core Application State & Utilities ---
        let currentPage = 'home';
        let currentDashboardTab = 'live_data';
        let currentSubsidiary = 'beacons'; // Default to the first launch entity

        const showMessage = (title, body, type = 'success') => {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4 transition-opacity duration-300';
            let bgColor = type === 'error' ? 'bg-red-900/90' : 'bg-green-900/90';
            modal.innerHTML = `
                <div class="cyber-card max-w-sm w-full p-6 text-center ${bgColor} ring-4 ring-offset-2 ring-offset-slate-950 ring-sky-500/50">
                    <h3 class="text-xl font-bold text-white mb-2">${title}</h3>
                    <p class="text-slate-200 text-sm">${body}</p>
                    <button onclick="this.closest('.fixed').remove()" class="mt-4 bg-sky-600 hover:bg-sky-700 text-white text-sm font-semibold py-2 px-4 rounded-lg transition shadow-lg">
                        Acknowledge
                    </button>
                </div>
            `;
            document.body.appendChild(modal);
        };

        const getElement = (id) => document.getElementById(id);

        const navigate = (page, subsidiaryId = null) => {
            currentPage = page;
            if (subsidiaryId) currentSubsidiary = subsidiaryId;
            renderApp();
            // Scroll to top for page changes
            window.scrollTo({ top: 0, behavior: 'smooth' });
        };

        // --- Data Definitions (DO NOT CHANGE BUSINESS CONTENT) ---
        const subsidiaryData = [
            { id: 'beacons', tag: '🌐', title: 'Polar Beacons Technologies Ltd.', focus: 'Arctic Data & Mesh-Network (NunaNet)', content: 'First launch subsidiary. Develops NunaNet for real-time climate, permafrost, and atmospheric data. Ensures safety and provides global research datasets.', role: ['Tech Backbone', 'Data Licensing', 'Aviation Safety'], dependents: ['GlacierLabs', 'North Winds Airlines', 'Ima Sealift'] },
            { id: 'arctrek', tag: '🥾', title: 'ArcTrek Expeditions Ltd.', focus: 'Inuit-Owned Adventure & Cultural Tourism', content: 'Offers high-end expeditions across Nunavut\'s National Parks. Focuses on youth guide apprenticeships and ensures tourism benefits stay local.', role: ['Global Visibility', 'Youth Training', 'Charter Client'], dependents: ['North Winds Airlines', 'Polar Express', 'Illuvigaq Real Estate'] },
            { id: 'express', tag: '🏪', title: 'Polar Express Stores / Ulu & Brew', focus: 'Modern Retail, Groceries & Community Hubs', content: 'Modernizes Northern retail for affordability and selection. Ulu & Brew creates social gathering spaces. Creates competition to reduce high costs.', role: ['Consumer-Facing Arm', 'Anchor Logistics Client', 'Community Identity'], dependents: ['Ima Sealift', 'North Winds Airlines'] },
            { id: 'illuvigaq', tag: '🏠', title: 'Illuvigaq Real Estate', focus: 'Modular Housing & Infrastructure Development', content: 'Builds energy-efficient housing tailored for Arctic conditions, durability, and cultural fit. Addresses the severe Nunavut housing crisis.', role: ['Infrastructure Provider', 'Housing Contracts', 'Subsidiary Facility Build-out'], dependents: ['Polar Beacons', 'ArcTrek', 'North Winds Airlines'] },
            { id: 'winds', tag: '✈️', title: 'North Winds Airlines', focus: 'Community-Based Arctic Aviation & Cargo', content: 'Regional airline operating a hybrid fleet for passengers and cargo. Ensures local control, employment, and resilient operations independent of southern operators.', role: ['Mobility Link', 'Charter Services', 'Logistics Partner'], dependents: ['ArcTrek', 'Polar Express', 'Ima Sealift'] },
            { id: 'ima', tag: '🚢', title: 'Ima Sealift Solutions', focus: 'Sealift & Marine Supply Chain Logistics', content: 'Handles bulk cargo and building materials by sea. Puts Inuit in charge of the main supply chain, tackling delays and southern profit extraction.', role: ['Supply Chain Control', 'Bulk Cargo Handler', 'Anchor Client'], dependents: ['Polar Express', 'Illuvigaq Real Estate', 'North Winds Airlines'] },
            { id: 'glacierlabs', tag: '🧊', title: 'GlacierLabs', focus: 'Environmental & Scientific Research Authority', content: 'Research arm partnering with global institutions to study permafrost, climate change, and ecosystems, merging Inuit Qaujimajatuqangit (IQ) with scientific data.', role: ['Scientific Authority', 'Research Grants', 'Data Utilization'], dependents: ['Polar Beacons', 'ArcTrek', 'NunaBank (Future)'] },
            { id: 'nunabank', tag: '💳', title: 'NunaBank (Future Subsidiary)', focus: 'Inuit-Centered Financial Services & Microfinance', content: 'Future financial institution providing basic banking, microfinance for entrepreneurs, and digital wallets, ensuring capital is retained in the North.', role: ['Financial Ecosystem', 'Capital Retention', 'Entrepreneur Support'], dependents: ['All Subsidiaries'] },
        ];

        const corporateTeam = [
            { name: 'Adam Aliqatuqtuq', role: 'Founder & CEO', focus: 'Visionary architect of the NWPH ecosystem, responsible for strategic direction and foundational capital.' },
            { name: 'Sarah Pilakapsi', role: 'COO (Chief Operating Officer)', focus: 'Oversees operational integration across subsidiaries, specializing in logistics and Arctic planning.' },
            { name: 'David Qamaniq', role: 'CFO (Chief Financial Officer)', focus: 'Manages corporate finance, long-term fiscal planning, and preparation for the NunaBank launch.' },
            { name: 'Dr. Aipilik Inuarak', role: 'CTO (Chief Technology Officer)', focus: 'Leads Polar Beacons and the implementation of NunaNet, expert in mesh networking and remote sensing.' },
            { name: 'Malaya Killabuk', role: 'Chief Cultural & HR Officer', focus: 'Ensures Inuit Qaujimajatuqangit (IQ) integration, talent management, and apprenticeship program oversight.' },
        ];

        // --- Layout Components ---
        const renderNavbar = () => {
            const navItems = [
                { id: 'home', name: 'Corporate Overview' },
                { id: 'subsidiaries', name: 'Ecosystem' },
                { id: 'dashboard', name: 'NunaNet' },
                { id: 'glacierlabs', name: 'Research' },
                { id: 'contact', name: 'Partnerships' }
            ];
            return `
                <header class="sticky top-0 z-50 bg-slate-950/95 backdrop-blur-md border-b border-sky-600/50 shadow-xl">
                    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                        <div class="flex items-center justify-between h-20">
                            <a href="#" onclick="navigate('home')" class="flex items-center space-x-2">
                                <span class="text-4xl font-extrabold tracking-widest text-white transform skew-x-[-10deg] inline-block">NWPH</span>
                                <span class="text-xs text-sky-400 font-light hidden sm:block pt-1">NORTH WEST PASSAGE HOLDINGS</span>
                            </a>
                            <nav class="hidden md:flex space-x-8">
                                ${navItems.map(item => `
                                    <button onclick="navigate('${item.id}')"
                                            class="nav-link text-sm font-semibold uppercase tracking-wider transition duration-300 text-slate-300 ${currentPage === item.id ? 'active' : 'hover:text-sky-400'}">
                                        ${item.name}
                                    </button>
                                `).join('')}
                            </nav>
                            <button class="md:hidden text-slate-300 hover:text-sky-400 p-2 rounded-lg" onclick="toggleMobileMenu()">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" /></svg>
                            </button>
                        </div>
                    </div>
                    <div id="mobile-menu" class="hidden md:hidden bg-slate-900 shadow-xl">
                         ${navItems.map(item => `
                            <button onclick="navigate('${item.id}'); toggleMobileMenu();"
                                    class="block w-full text-left px-6 py-3 text-base font-medium transition duration-300 hover:bg-sky-900/30 ${currentPage === item.id ? 'text-sky-400 bg-sky-900/20' : 'text-slate-300'}">
                                ${item.name}
                            </button>
                        `).join('')}
                    </div>
                </header>
            `;
        };

        const toggleMobileMenu = () => {
            const menu = getElement('mobile-menu');
            if (menu) menu.classList.toggle('hidden');
        };

        const renderFooter = () => `
            <footer class="bg-slate-950/70 border-t border-sky-800/30 mt-20 py-12">
                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-sm">
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-8">
                        <!-- Column 1: Mission -->
                        <div>
                            <h3 class="font-bold text-sky-400 mb-4 uppercase tracking-widest text-xs">Mission & Vision</h3>
                            <ul class="space-y-2 text-slate-400">
                                <li>Economic Sovereignty</li>
                                <li>Inuit-Led Governance</li>
                                <li>Resilience Through Diversification</li>
                            </ul>
                        </div>
                        <!-- Column 2: Sectors -->
                        <div>
                            <h3 class="font-bold text-sky-400 mb-4 uppercase tracking-widest text-xs">Operational Sectors</h3>
                            <ul class="space-y-2 text-slate-400">
                                <li>Technology & Data ($\text{Polar Beacons}$)</li>
                                <li>Logistics & Supply Chain ($\text{Ima Sealift}$)</li>
                                <li>Aviation & Mobility ($\text{North Winds}$)</li>
                            </ul>
                        </div>
                        <!-- Column 3: Contact -->
                        <div>
                            <h3 class="font-bold text-sky-400 mb-4 uppercase tracking-widest text-xs">Global Reach</h3>
                            <ul class="space-y-2 text-slate-400">
                                <li>HQ: Qikiqtarjuaq, Nunavut</li>
                                <li>Logistics Hub: Iqaluit, Nunavut</li>
                                <li>Liaison Office: Ottawa, Ontario</li>
                            </ul>
                        </div>
                        <!-- Column 4: Compliance -->
                        <div>
                            <h3 class="font-bold text-sky-400 mb-4 uppercase tracking-widest text-xs">Compliance</h3>
                            <ul class="space-y-2 text-slate-400">
                                <li>Environmental Stewardship</li>
                                <li>Cultural Integration Charter</li>
                                <li>$\text{NWPH}_{\text{Legal}}$</li>
                            </ul>
                        </div>
                    </div>
                    <div class="mt-10 pt-6 border-t border-sky-800/20 text-center text-slate-500 text-xs">
                        &copy; ${new Date().getFullYear()} North West Passage Holdings ($\text{NWPH}$). Inuit-Owned and Operated. | Reimagining the Arctic Economy.
                    </div>
                </div>
            </footer>
        `;

        // --- Page Components ---
        const renderHome = () => `
            <main class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-16 pb-12">
                <!-- Hero Section: Visionary Statement -->
                <section class="text-center py-20 bg-slate-900/70 cyber-card mb-16 shadow-2xl">
                    <h1 class="text-6xl md:text-7xl font-extrabold text-white mb-4 leading-snug">
                        The Arctic, <span class="text-transparent bg-clip-text bg-gradient-to-r from-sky-300 to-sky-500">Reimagined</span>.
                    </h1>
                    <p class="text-xl md:text-2xl text-slate-300 mb-10 max-w-4xl mx-auto font-light">
                        North West Passage Holdings is the Inuit-owned enterprise forging a self-sustaining Arctic economy—driven by **cultural wisdom**, **cutting-edge technology**, and **unwavering resilience**.
                    </p>
                    <div class="flex flex-col sm:flex-row justify-center space-y-4 sm:space-y-0 sm:space-x-6">
                        <button onclick="navigate('subsidiaries')" class="bg-sky-600 hover:bg-sky-700 text-white font-bold py-3 px-8 rounded-full transition duration-300 transform hover:scale-[1.03] shadow-lg shadow-sky-900/50">
                            Explore the Ecosystem &rarr;
                        </button>
                        <button onclick="navigate('dashboard')" class="bg-transparent border border-sky-500 text-sky-400 font-bold py-3 px-8 rounded-full transition duration-300 hover:bg-sky-900/50 hover:border-sky-400">
                            View $\text{NunaNet}$ $\text{Live}$ $\text{Data}$
                        </button>
                    </div>
                </section>

                <!-- Corporate Leadership -->
                <h2 class="text-4xl font-extrabold text-white mb-10 text-center">Inuit-Led Corporate Leadership</h2>
                <div class="grid sm:grid-cols-2 md:grid-cols-5 gap-6 mb-16">
                    ${corporateTeam.map(member => `
                        <div class="cyber-card p-5 rounded-xl text-center transition duration-500 hover:bg-sky-900/30">
                            <svg class="w-10 h-10 text-sky-400 mb-3 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>
                            <h3 class="text-lg font-extrabold text-white uppercase tracking-wider">${member.name}</h3>
                            <p class="text-xs font-semibold text-sky-400 mt-1 mb-2">${member.role}</p>
                            <p class="text-xs text-slate-500 line-clamp-3">${member.focus}</p>
                        </div>
                    `).join('')}
                </div>

                <!-- Core Guiding Principles -->
                <h2 class="text-4xl font-extrabold text-white mb-10 text-center">Foundational Pillars</h2>
                <div class="grid sm:grid-cols-2 md:grid-cols-5 gap-6 mb-16">
                    ${[
                        { title: 'Inuit-Led Governance', icon: 'M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zM12 20c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-10h2v6h-2z', subtitle: 'Decision-making rooted in Northern communities.' },
                        { title: 'Resilience through Diversification', icon: 'M16 18l-6-6-4 4-2-2-4 4v2h16z', subtitle: 'Multi-sector spread eliminates single points of failure.' },
                        { title: 'Economic Sovereignty', icon: 'M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zM12 20c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-10h2v6h-2z', subtitle: 'Wealth generation retained within Nunavut.' },
                        { title: 'Sustainability', icon: 'M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 18c-3.86 0-7-3.14-7-7V6.3l7-3.5 7 3.5V12c0 3.86-3.14 7-7 7z', subtitle: 'Harmonizing growth with environmental stewardship.' },
                        { title: 'Interconnected Model', icon: 'M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zm-1 9V4.5l5.5 5.5H13z', subtitle: 'Each subsidiary strengthens the entire NWPH collective.' },
                    ].map(item => `
                        <div class="cyber-card p-4 rounded-xl text-center transition duration-500 hover:bg-slate-800/80">
                            <svg class="w-8 h-8 text-sky-400 mb-2 mx-auto" fill="currentColor" viewBox="0 0 24 24"><path d="${item.icon}"/></svg>
                            <h3 class="text-xs font-bold text-white uppercase tracking-wider">${item.title}</h3>
                            <p class="text-[0.65rem] text-slate-500 mt-1">${item.subtitle}</p>
                        </div>
                    `).join('')}
                </div>
            </main>
        `;

        const renderSubsidiaries = () => {
            const currentSub = subsidiaryData.find(s => s.id === currentSubsidiary);

            return `
                <main class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
                    <h2 class="text-5xl font-extrabold text-white mb-4 border-b border-sky-400/30 pb-3">The $\text{NWPH}$ Subsidiary Ecosystem Architecture</h2>
                    <p class="text-xl text-slate-400 mb-12">
                        A circular economic model: wealth and innovation generated by one entity flow directly into the others, reinforcing the entire North West Passage Holdings group.
                    </p>

                    <div class="grid lg:grid-cols-12 gap-8">
                        <!-- Sidebar: Subsidiary Selector (List) -->
                        <div class="lg:col-span-3">
                            <h3 class="text-xl font-bold text-sky-400 mb-4 uppercase tracking-wider">8 Pillars of Growth</h3>
                            <div class="space-y-3">
                                ${subsidiaryData.map(sub => `
                                    <button onclick="navigate('subsidiaries', '${sub.id}')"
                                            class="cyber-card w-full text-left p-4 transition duration-300 ${currentSubsidiary === sub.id ? 'bg-sky-900/40 border-l-4 border-sky-400 ring-1 ring-sky-400' : 'hover:bg-slate-800/80'}">
                                        <p class="text-base font-bold ${currentSubsidiary === sub.id ? 'text-white' : 'text-slate-300'}">${sub.tag} ${sub.title}</p>
                                        <p class="text-xs ${currentSubsidiary === sub.id ? 'text-sky-300' : 'text-slate-500'} font-medium mt-1">${sub.focus}</p>
                                    </button>
                                `).join('')}
                            </div>
                        </div>

                        <!-- Main Content: Detailed Subsidiary View -->
                        <div class="lg:col-span-9 cyber-card p-8">
                            <span class="text-5xl block mb-2">${currentSub.tag}</span>
                            <h3 class="text-4xl font-extrabold text-white mb-2">${currentSub.title}</h3>
                            <h4 class="text-xl font-medium text-sky-400 mb-6 border-b border-slate-700/50 pb-3">${currentSub.focus}</h4>

                            <p class="text-slate-300 mb-8">${currentSub.content}</p>

                            <!-- Role & Business Model Grid -->
                            <div class="grid md:grid-cols-2 gap-6 mb-8">
                                <div class="p-4 border border-slate-700 rounded-lg bg-slate-900/50">
                                    <h5 class="text-lg font-bold text-white mb-3 text-sky-400">Strategic Corporate Role</h5>
                                    <ul class="list-disc list-inside space-y-2 text-slate-400 text-sm pl-4">
                                        ${currentSub.role.map(r => `<li>${r}</li>`).join('')}
                                    </ul>
                                </div>
                                <div class="p-4 border border-slate-700 rounded-lg bg-slate-900/50">
                                    <h5 class="text-lg font-bold text-white mb-3 text-sky-400">Core Dependencies & Synergies</h5>
                                    <div class="flex flex-wrap gap-2 text-sm">
                                        ${currentSub.dependents.map(dName => {
                                            const dep = subsidiaryData.find(s => s.title === dName);
                                            return `<span onclick="navigate('subsidiaries', '${dep ? dep.id : ''}')" class="bg-slate-700 hover:bg-slate-600 text-xs text-white py-1 px-3 rounded-full cursor-pointer transition">${dep ? dep.tag : ''} ${dName}</span>`;
                                        }).join('')}
                                    </div>
                                </div>
                            </div>

                            <!-- Interconnection Visualization (Dynamic) -->
                            <div class="mt-8 p-6 bg-sky-900/20 rounded-lg border border-sky-600/50">
                                <h5 class="text-xl font-bold text-white mb-4">Ecosystem Flow Diagram</h5>
                                <div class="flex flex-wrap items-center justify-start text-sm">
                                    <span class="bg-sky-600/90 text-white font-semibold py-1.5 px-4 rounded-full mr-4 mb-2 shadow-md">${currentSub.tag} ${currentSub.title} (Origin)</span>
                                    <span class="text-slate-300 text-2xl mr-4 mb-2">&rarr;</span>
                                    <div class="flex flex-wrap gap-2">
                                        ${currentSub.dependents.map(dName => {
                                            const dep = subsidiaryData.find(s => s.title === dName);
                                            return `<span onclick="navigate('subsidiaries', '${dep ? dep.id : ''}')" class="bg-slate-700 hover:bg-slate-600 text-xs text-white py-1.5 px-3 rounded-full cursor-pointer transition">${dep ? dep.tag : ''} ${dName}</span>`;
                                        }).join('')}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </main>
            `;
        };

        const renderDashboard = () => `
            <main class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
                <h2 class="text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-sky-400 to-cyan-400 mb-2">Polar Beacons $\text{NunaNet}$ Interface</h2>
                <p class="text-xl text-slate-400 mb-8">
                    Harnessing $10^{9}$ data points from our distributed Arctic mesh-network. Real-time intelligence for all $\text{NWPH}$ operations.
                </p>

                <div class="cyber-card p-6">
                    <!-- Dashboard Tabs -->
                    <div class="flex border-b border-sky-600/50 mb-6 space-x-6">
                        ${[
                            { id: 'live_data', name: 'Real-Time Data Streams' },
                            { id: '3d_model', name: 'NunaNet $\text{SAT}_{\text{Model}}$ Visualization' },
                            { id: 'fleet_tracking', name: 'Fleet Logistics Overlay' }
                        ].map(tab => `
                            <button class="py-3 px-2 text-sm font-bold transition duration-300 ${tab.id === currentDashboardTab ? 'text-sky-400 border-b-2 border-sky-400' : 'text-slate-400 hover:text-sky-300'}"
                                    onclick="loadDashboardTab('${tab.id}')">
                                ${tab.name}
                            </button>
                        `).join('')}
                    </div>

                    <!-- Dynamic Content Area -->
                    <div id="dashboard-content">
                        <!-- Content rendered by loadDashboardTab -->
                    </div>
                </div>
            </main>
        `;

        const renderDashboardContent = (tab) => {
            if (tab === 'live_data') {
                const metrics = [
                    { title: 'NunaNet Uptime $\text{Pct}$', value: '$99.992\%$', trend: 'Stable', color: 'text-green-400', icon: 'M5 13l4 4L19 7' },
                    { title: 'Permafrost Stability Index ($\text{PSI}$)', value: '$6.7 \text{ kPA}$', trend: 'Watch: $-0.2 \text{ kPA}$', color: 'text-yellow-400', icon: 'M13 10V3L4 14h7v7l9-11h-7z' },
                    { title: 'North Winds Flight Safety $\text{Score}$', value: '$98.3$', trend: 'Improved', color: 'text-green-400', icon: 'M12 19l9 2-9-18-9 18 9-2zm0 0v-8' },
                    { title: 'Ima Sealift Ice Density $\text{Alerts}$', value: '4', trend: 'Increased', color: 'text-red-400', icon: 'M20 10V8a2 2 0 00-2-2h-3' },
                ];
                return `
                    <div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                        ${metrics.map(metric => `
                            <div class="cyber-card p-5 border-l-4 border-${metric.color.replace('text-', '')} transition duration-300 hover:bg-slate-800/70">
                                <h4 class="text-xs ${metric.color} font-semibold uppercase tracking-wider">${metric.title}</h4>
                                <p class="text-3xl font-extrabold text-white mt-1">${metric.value}</p>
                                <div class="flex items-center text-sm text-slate-500 mt-2">
                                    <svg class="w-4 h-4 mr-1 ${metric.color}" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="${metric.icon}"></path></svg>
                                    ${metric.trend}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    <!-- Detailed Feed Simulation -->
                    <div class="bg-slate-900/80 p-6 rounded-xl border border-sky-800 shadow-inner shadow-sky-900/50">
                        <h3 class="text-xl font-semibold text-white mb-4 border-b border-slate-700 pb-2 text-sky-300">Integrated Operational Feed</h3>
                        <div class="h-64 overflow-y-auto space-y-3 text-sm text-slate-400 font-mono pr-2">
                            <div class="flex items-start space-x-2"><span class="text-sky-400 flex-shrink-0">[NunaNet]</span><p>Atmospheric Model V5.1 deployed. $\text{North Winds}_{\text{Pilots}}$ receiving updated turbulence data ($\text{Qikiqtarjuaq}$ $\text{sector}$).</p></div>
                            <div class="flex items-start space-x-2"><span class="text-green-500 flex-shrink-0">[Ima Sealift]</span><p>Container Ship **Sila** confirmed arrival at Resolute Bay. Polar Express resupply $\text{98\%}$ on schedule.</p></div>
                            <div class="flex items-start space-x-2"><span class="text-yellow-500 flex-shrink-0">[GlacierLabs]</span><p>Warning: Permafrost sensor $\text{ID}_{\text{703}}$ near Baker Lake shows $\text{0.7\%}$ subsidence acceleration. $\text{Illuvigaq}$ advised.</p></div>
                            <div class="flex items-start space-x-2"><span class="text-sky-400 flex-shrink-0">[ArcTrek]</span><p>Expedition $\text{AT-24-005}$ itinerary approved based on real-time floe edge stability assessment.</p></div>
                            <div class="flex items-start space-x-2"><span class="text-green-500 flex-shrink-0">[Illuvigaq]</span><p>New modular housing unit ($\text{M-42}$) foundation pour completed in low-wind conditions (via $\text{NunaNet}$ $\text{forecast}$).</p></div>
                            <div class="flex items-start space-x-2"><span class="text-red-500 flex-shrink-0">[System Alert]</span><p>High-priority $\text{DDoS}$ probe detected and mitigated. Security integrity restored $\text{100\%}$.</p></div>
                        </div>
                    </div>
                `;
            } else if (tab === '3d_model') {
                return `
                    <h3 class="text-2xl font-semibold text-white mb-4 text-center">NunaNet $\text{SAT}_{\text{Model}}$: Real-Time Telemetry Visualization</h3>
                    <div id="three-canvas-container" class="cyber-card relative flex items-center justify-center">
                        <div id="three-loader" class="flex flex-col items-center space-y-3 absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-10">
                            <div class="tech-loader"></div>
                            <span class="text-sky-400 font-medium">Initializing $\text{3D}$ $\text{Satellite}$ $\text{Model}$...</span>
                        </div>
                        <canvas id="three-canvas" class="w-full h-full rounded-xl"></canvas>
                    </div>
                    <p class="text-center text-sm text-slate-500 mt-4">Simulated $\text{NunaNet}$ satellite in orbit. Click and drag to adjust camera angle. (Requires $\text{Polar Beacons}_{\text{Level 4}}$ telemetry license)</p>
                `;
            } else if (tab === 'fleet_tracking') {
                return `
                    <div class="p-10 text-center bg-slate-800/50 rounded-lg h-96 flex flex-col justify-center items-center border border-sky-700">
                        <svg class="w-12 h-12 text-sky-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                        <h4 class="text-2xl font-bold text-white mb-2">Integrated Fleet Logistics Overlay</h4>
                        <p class="text-slate-400 max-w-lg">
                            This module provides a unified geospatial view of $\text{North Winds}$ $\text{Airlines}$ aircraft and $\text{Ima Sealift}$ $\text{Solutions}$ vessel movements. **Access is restricted** to $\text{NWPH}_{\text{Logistics}}$ $\text{Suite}$ $\text{Subscribers}$ for security and operational integrity.
                        </p>
                    </div>
                `;
            }
        };

        window.loadDashboardTab = (tabId) => {
            currentDashboardTab = tabId;
            const dashboardContent = getElement('dashboard-content');
            if (dashboardContent) {
                // Clear any existing 3D scene before rendering new content
                if (renderer) {
                    renderer.dispose();
                    renderer = null;
                }

                dashboardContent.innerHTML = renderDashboardContent(tabId);
                if (tabId === '3d_model') {
                    // Start Three.js initialization after content is in DOM
                    setTimeout(initThreeJS, 100);
                }
            }
        };

        // --- Three.js Implementation (Refined for responsiveness and cleanup) ---
        let scene, camera, renderer, earthContainer, resizeObserver;

        const initThreeJS = () => {
            const container = getElement('three-canvas-container');
            const loader = getElement('three-loader');
            const canvas = getElement('three-canvas');

            if (!container || !loader || !canvas) return;

            // Show loader and set a simulated delay
            loader.classList.remove('hidden');

            setTimeout(() => {
                loader.classList.add('hidden');
                
                const width = container.clientWidth;
                const height = container.clientHeight;

                // 1. Scene setup
                scene = new THREE.Scene();
                
                // 2. Camera setup
                camera = new THREE.PerspectiveCamera(75, width / height, 0.1, 1000);
                camera.position.z = 10;

                // 3. Renderer setup
                renderer = new THREE.WebGLRenderer({ canvas: canvas, antialias: true, alpha: true });
                renderer.setSize(width, height);
                renderer.setPixelRatio(window.devicePixelRatio); // For sharper rendering

                // 4. Lighting
                scene.add(new THREE.AmbientLight(0x404040, 5));
                const directionalLight = new THREE.DirectionalLight(0xffffff, 2);
                directionalLight.position.set(5, 5, 5).normalize();
                scene.add(directionalLight);

                // 5. Earth and Orbit Container
                earthContainer = new THREE.Group();
                scene.add(earthContainer);
                
                const earth = new THREE.Mesh(
                    new THREE.SphereGeometry(3, 32, 32),
                    new THREE.MeshPhongMaterial({ color: 0x003366, shininess: 10 })
                );
                earthContainer.add(earth);
                
                const orbit = new THREE.Mesh(
                    new THREE.RingGeometry(4.4, 4.45, 64),
                    new THREE.MeshBasicMaterial({ color: 0x38BDF8, side: THREE.DoubleSide })
                );
                orbit.rotation.x = Math.PI / 2;
                earthContainer.add(orbit);
                
                // 6. Satellite Model
                const satellite = new THREE.Group();
                satellite.add(new THREE.Mesh( // Body
                    new THREE.BoxGeometry(0.5, 0.5, 0.5),
                    new THREE.MeshPhongMaterial({ color: 0xcccccc })
                ));
                
                const panelMaterial = new THREE.MeshPhongMaterial({ color: 0x06b6d4 });
                
                const panelGeometry = new THREE.BoxGeometry(2, 0.1, 1);
                const panel1 = new THREE.Mesh(panelGeometry, panelMaterial);
                panel1.position.x = 1.25;
                satellite.add(panel1);

                const panel2 = new THREE.Mesh(panelGeometry, panelMaterial);
                panel2.position.x = -1.25;
                satellite.add(panel2);
                
                const antenna = new THREE.Mesh( // Antenna
                    new THREE.ConeGeometry(0.1, 0.5, 8),
                    new THREE.MeshPhongMaterial({ color: 0x38bdf8 })
                );
                antenna.position.y = 0.5;
                satellite.add(antenna);

                satellite.position.set(4.5, 0, 0);
                earthContainer.add(satellite);
                
                // 7. Interaction Controls
                let isDragging = false;
                let previousMousePosition = { x: 0, y: 0 };

                const onPointerDown = (clientX, clientY) => {
                    isDragging = true;
                    previousMousePosition = { x: clientX, y: clientY };
                };
                const onPointerUp = () => { isDragging = false; };
                const onPointerMove = (clientX, clientY) => {
                    if (!isDragging) return;
                    const deltaX = clientX - previousMousePosition.x;
                    const deltaY = clientY - previousMousePosition.y;

                    earthContainer.rotation.y += deltaX * 0.005;
                    earthContainer.rotation.x += deltaY * 0.005;

                    previousMousePosition = { x: clientX, y: clientY };
                };

                // Mouse handlers
                container.addEventListener('mousedown', (e) => onPointerDown(e.clientX, e.clientY));
                container.addEventListener('mouseup', onPointerUp);
                container.addEventListener('mousemove', (e) => onPointerMove(e.clientX, e.clientY));
                
                // Touch handlers
                container.addEventListener('touchstart', (e) => {
                    if (e.touches.length === 1) onPointerDown(e.touches[0].clientX, e.touches[0].clientY);
                }, { passive: true });
                container.addEventListener('touchend', onPointerUp);
                container.addEventListener('touchmove', (e) => {
                    if (e.touches.length === 1) onPointerMove(e.touches[0].clientX, e.touches[0].clientY);
                }, { passive: true });

                // 8. Resize Handling (Using ResizeObserver for cleaner canvas resizing)
                const handleResize = () => {
                    if (!renderer) return;
                    const newWidth = container.clientWidth;
                    const newHeight = container.clientHeight;
                    camera.aspect = newWidth / newHeight;
                    camera.updateProjectionMatrix();
                    renderer.setSize(newWidth, newHeight);
                };

                resizeObserver = new ResizeObserver(handleResize);
                resizeObserver.observe(container);

                // 9. Start Animation Loop
                animateThreeJS(satellite);

            }, 2000); // 2 second simulated initialization delay
        };

        const animateThreeJS = (satellite) => {
            if (!renderer) return;

            requestAnimationFrame(() => animateThreeJS(satellite));

            // Rotate the earth and satellite orbit subtly
            earthContainer.rotation.z += 0.001;
            satellite.rotation.y += 0.01;

            renderer.render(scene, camera);
        };

        // --- GlacierLabs Research & Grant Page ---
        const renderGlacierLabs = () => `
            <main class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
                <h2 class="text-5xl font-extrabold text-white mb-4 border-b border-sky-400/30 pb-3">GlacierLabs: Research Partnership & Grant Portal</h2>
                <p class="text-xl text-slate-400 mb-12 max-w-4xl">
                    We seek collaborative research proposals that leverage our $\text{NunaNet}_{\text{Data}}$ and respect $\text{Inuit Qaujimajatuqangit}$ ($\text{IQ}$). Submit your formal application for the **Arctic Resilience Grant ($\text{ARG}$)** below.
                </p>

                <div class="grid md:grid-cols-3 gap-8">
                    <!-- Research Focus Card -->
                    <div class="md:col-span-1 cyber-card p-6 h-full border-l-4 border-cyan-400">
                        <h3 class="text-2xl font-bold text-sky-400 mb-4">Core Research Areas</h3>
                        <ul class="space-y-3 text-sm text-slate-300">
                            <li class="flex items-start"><span class="text-sky-400 mr-2 font-extrabold text-lg">&#x2022;</span> Permafrost $\text{Thermal}$ Dynamics</li>
                            <li class="flex items-start"><span class="text-sky-400 mr-2 font-extrabold text-lg">&#x2022;</span> High-Latitude $\text{Atmospheric}$ Chemistry</li>
                            <li class="flex items-start"><span class="text-sky-400 mr-2 font-extrabold text-lg">&#x2022;</span> Sea Ice $\text{Mobility}$ $\text{Modeling}$ ($\text{IQ}$ $\text{Integration}$)</li>
                            <li class="flex items-start"><span class="text-sky-400 mr-2 font-extrabold text-lg">&#x2022;</span> Ecosystem $\text{Adaptation}$ $\text{Studies}$</li>
                            <li class="flex items-start"><span class="text-sky-400 mr-2 font-extrabold text-lg">&#x2022;</span> Arctic $\text{Infrastructure}$ Durability ($\text{Illuvigaq}$ synergy)</li>
                        </ul>
                    </div>

                    <!-- Grant Application Form -->
                    <div class="md:col-span-2 cyber-card p-8">
                        <h3 class="text-2xl font-bold text-white mb-6">Arctic Resilience Grant ($\text{ARG}$) Application</h3>
                        <form id="grant-form" onsubmit="handleGrantSubmit(event)">
                            <div class="space-y-4">
                                <div>
                                    <label for="institution" class="block text-sm font-medium text-slate-300 mb-1">Affiliated Institution</label>
                                    <input type="text" id="institution" required class="w-full p-3 bg-slate-800/70 border border-slate-700 rounded-lg text-white focus:ring-sky-500 focus:border-sky-500">
                                </div>
                                <div>
                                    <label for="budget" class="block text-sm font-medium text-slate-300 mb-1">Requested Budget ($\$ \text{CAD}$)</label>
                                    <input type="number" id="budget" required min="50000" max="1000000" class="w-full p-3 bg-slate-800/70 border border-slate-700 rounded-lg text-white focus:ring-sky-500 focus:border-sky-500">
                                    <p class="text-xs text-slate-500 mt-1">Min: $50,000 \text{ CAD}$ - Max: $1,000,000 \text{ CAD}$</p>
                                </div>
                                <div>
                                    <label for="abstract" class="block text-sm font-medium text-slate-300 mb-1">Project Abstract (max 500 characters)</label>
                                    <textarea id="abstract" rows="4" required maxlength="500" class="w-full p-3 bg-slate-800/70 border border-slate-700 rounded-lg text-white focus:ring-sky-500 focus:border-sky-500"></textarea>
                                </div>
                                <div class="flex items-center">
                                    <input type="checkbox" id="iq_compliance" required class="h-4 w-4 text-sky-600 bg-slate-800 border-slate-600 rounded focus:ring-sky-500">
                                    <label for="iq_compliance" class="ml-2 block text-sm text-slate-400">
                                        I confirm adherence to the $\text{GlacierLabs}$ $\text{IQ}$ $\text{Integration}$ $\text{Protocol}$ ($\text{MANDATORY}$).
                                    </label>
                                </div>
                                <button type="submit" class="w-full bg-gradient-to-r from-sky-600 to-cyan-500 hover:from-sky-700 hover:to-cyan-600 text-white font-bold py-3 rounded-lg transition duration-300 transform hover:scale-[1.01] shadow-lg shadow-sky-900/50">
                                    Submit $\text{ARG}$ $\text{Proposal}$ ($\text{Simulated}$ $\text{API}$ $\text{Call}$)
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </main>
        `;

        window.handleGrantSubmit = (event) => {
            event.preventDefault();
            const form = getElement('grant-form');
            const budget = getElement('budget').value;
            form.classList.add('opacity-50', 'pointer-events-none');

            setTimeout(() => {
                form.classList.remove('opacity-50', 'pointer-events-none');
                showMessage(
                    'Proposal Received',
                    `Thank you. Your Arctic Resilience Grant proposal for $\$${Number(budget).toLocaleString()} \text{ CAD}$ has been logged with the $\text{GlacierLabs}_{\text{Review}}$ $\text{Board}$. Reference $\text{ID}$: $\text{ARG-25-0012}$.`,
                    'success'
                );
                form.reset();
            }, 1500); // Simulated delay
        };

        const renderContact = () => `
            <main class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
                <h2 class="text-5xl font-extrabold text-white mb-4 border-b border-sky-400/30 pb-3">Strategic Partnerships & Global Engagement</h2>
                <p class="text-xl text-slate-400 mb-12 max-w-4xl">
                    $\text{North West Passage Holdings}$ is actively seeking partners in $\text{finance}$, $\text{government}$, $\text{technology}$, and $\text{sustainable}$ $\text{development}$. Connect with our liaison offices below.
                </p>

                <div class="grid md:grid-cols-3 gap-8">
                    <!-- Global Offices -->
                    ${[
                        { title: 'Qikiqtarjuaq, Nunavut', role: 'Inuit-Led Corporate Headquarters (HQ)', contact: 'info@nwph.ca', focus: 'Operational Strategy & Cultural Governance' },
                        { title: 'Iqaluit, Nunavut', role: 'Northern Logistics & Tech Hub', contact: 'logistics@nwph.ca', focus: 'Ima Sealift, North Winds, and Polar Beacons Base' },
                        { title: 'Ottawa, Ontario', role: 'National & Global Liaison Office', contact: 'partnerships@nwph.ca', focus: 'Investment Relations, Government Contracts & Finance' }
                    ].map(office => `
                        <div class="cyber-card p-6 transition duration-300 hover:bg-slate-800/70 border-l-4 border-sky-600">
                            <h4 class="text-2xl font-bold text-sky-400 mb-2">${office.title}</h4>
                            <p class="text-sm font-semibold text-white mb-3">${office.role}</p>
                            <p class="text-xs text-slate-500 mb-3">${office.focus}</p>
                            <p class="text-sm text-slate-300 font-mono">${office.contact}</p>
                        </div>
                    `).join('')}
                </div>

                <!-- Inquiry Form -->
                <div class="mt-16 cyber-card p-8 max-w-3xl mx-auto">
                    <h3 class="text-2xl font-bold text-white mb-6 text-center">Direct Partnership Inquiry</h3>
                    <form id="inquiry-form" onsubmit="handleInquirySubmit(event)">
                        <div class="space-y-4">
                            <div>
                                <label for="contact_name" class="block text-sm font-medium text-slate-300 mb-1">Your Name / Title</label>
                                <input type="text" id="contact_name" required class="w-full p-3 bg-slate-800/70 border border-slate-700 rounded-lg text-white focus:ring-sky-500 focus:border-sky-500">
                            </div>
                            <div>
                                <label for="area" class="block text-sm font-medium text-slate-300 mb-1">Inquiry Focus Area</label>
                                <select id="area" required class="w-full p-3 bg-slate-800/70 border border-slate-700 rounded-lg text-white focus:ring-sky-500 focus:border-sky-500">
                                    <option value="">Select a Subsidiary or Sector</option>
                                    ${subsidiaryData.map(sub => `<option value="${sub.title}">${sub.title}</option>`).join('')}
                                    <option value="General Investment">General Investment</option>
                                    <option value="Media Relations">Media Relations</option>
                                </select>
                            </div>
                            <div>
                                <label for="details" class="block text-sm font-medium text-slate-300 mb-1">Inquiry Details</label>
                                <textarea id="details" rows="5" required class="w-full p-3 bg-slate-800/70 border border-slate-700 rounded-lg text-white focus:ring-sky-500 focus:border-sky-500"></textarea>
                            </div>
                            <button type="submit" class="w-full bg-gradient-to-r from-sky-600 to-cyan-500 hover:from-sky-700 hover:to-cyan-600 text-white font-bold py-3 rounded-lg transition duration-300 transform hover:scale-[1.01] shadow-lg shadow-sky-900/50">
                                Submit Confidential Inquiry
                            </button>
                        </div>
                    </form>
                </div>
            </main>
        `;


        // --- Main Rendering & Initialization ---
        const renderApp = () => {
            const appDiv = getElement('app');

            // Render Navbar
            const navbarHTML = renderNavbar();
            appDiv.innerHTML = navbarHTML;

            // Determine Content
            let contentHTML;
            switch (currentPage) {
                case 'subsidiaries':
                    contentHTML = renderSubsidiaries();
                    break;
                case 'dashboard':
                    contentHTML = renderDashboard();
                    break;
                case 'glacierlabs':
                    contentHTML = renderGlacierLabs();
                    break;
                case 'contact':
                    contentHTML = renderContact();
                    break;
                case 'home':
                default:
                    contentHTML = renderHome();
                    break;
            }

            // Render Content and Footer
            appDiv.innerHTML += contentHTML;
            appDiv.innerHTML += renderFooter();

            // Special logic for the Dashboard content initialization
            if (currentPage === 'dashboard') {
                // Ensure the content is rendered *before* calling the tab loader
                setTimeout(() => loadDashboardTab(currentDashboardTab), 50);
            }
        };

        // Initialize the Application
        document.addEventListener('DOMContentLoaded', () => {
            // Check hash for initial page navigation
            const hash = window.location.hash.substring(1);
            if (['home', 'subsidiaries', 'dashboard', 'glacierlabs', 'contact'].includes(hash)) {
                currentPage = hash;
            }
            renderApp();
        });
    </script>
</body>
</html>